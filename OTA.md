# Hockey_Remote — ESP32 Wi‑Fi IR Controller

Проект прошивки для **ESP32 DevKit v1** (Arduino Framework, PlatformIO), предназначенной для управления хоккейным табло и сиреной по Wi‑Fi.

Управление осуществляется через **UDP бинарный протокол** с минимальной задержкой. Поддерживается сервисный режим **OTA‑обновления прошивки по Wi‑Fi**.

---

## Основные возможности

* Управление табло через IR (RC5)
* Управление сиреной с настраиваемыми паттернами
* Быстрый UDP‑протокол без JSON/HTTP
* Немедленный ACK и дедупликация команд
* Сервисный режим OTA без физического доступа к плате

---

## Аппаратная платформа

* ESP32 DevKit v1
* Flash: 4 MB
* Framework: Arduino
* Сборка: PlatformIO

---

## Структура проекта

```
Hockey_Remote/
├─ src/            # основной код прошивки
├─ include/        # заголовочные файлы
├─ lib/            # локальные библиотеки (если используются)
├─ test/           # тесты (необязательно)
├─ platformio.ini  # конфигурация PlatformIO
└─ .gitignore
```

---

## OTA‑обновление прошивки (кратко)

### ВАЖНО: питание

⚠ Во время OTA требуется **стабильное внешнее питание 5 V (≥ 2 A)**.

Прошивка **не должна обновляться от USB‑порта компьютера** — это может привести к:

* обрывам OTA на случайных процентах;
* провалам ping;
* зависаниям ESP32.

---

### 1. Перевод ESP32 в OTA‑режим (PowerShell)

```powershell
$udp = New-Object System.Net.Sockets.UdpClient
$udp.Connect("192.168.149.2", 4210)
$packet = [byte[]](0xA5,0x01,0x70,0x01,0x00,0x00)
$udp.Send($packet, $packet.Length) | Out-Null
$udp.Close()
```

---

### 2. Загрузка прошивки через PlatformIO

В каталоге проекта:

```powershell
pio run -t upload --upload-port 192.168.149.2
```

После успешной загрузки плата автоматически перезагружается.

---

## Примечания

* OTA‑режим является сервисным и временно отключает рабочую логику управления табло.
* При нестабильной загрузке первым делом проверяйте **питание**, а не сеть.

---

## Статус проекта

Проект используется в рабочей системе управления хоккейным табло и активно развивается.
